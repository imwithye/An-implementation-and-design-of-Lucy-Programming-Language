\chapter{Linker Implementation}
The Lucy compiler aims to compile the Lucy code into Lucy X module with solving the local linkage. The \texttt{Import} keyword is reserved for global linkage. The global linkage is solved during linking time by the Lucy linker. This chapter first discusses how the routine and module are represented and how the global linking is solved for those global function calls. Then we discuss the detailed implementation of the Lucy linker.


\section{Subroutine Representation}
In Lucy X assembly language, functions are represented as subroutines. A subroutine provides scope isolation and stack memory for parameter passing and function execution. For each subroutine produced by the Lucy compiler, it will be prefixed with the module name to differentiate the subroutines.
\begin{lstlisting}
package "string"

func len(s: string) {}
\end{lstlisting}
will be translated to
\begin{lstlisting}[language=LucyX]
string:len {
  pop s
}
\end{lstlisting}
In this case, inside a package, even the two functions are in different files, they cannot be the same name. Otherwise when the global linker links all module files into one module, the naming will be duplicated and an \texttt{OverdefinedException} will be thrown. But if these two functions are in two different packages, it will be fine if they have the same name since they will be prefixed their package's name.

\section{Module Representation}
Cras vitae diam urna. Pellentesque non mi sodales, cursus velit in, dapibus dolor. Nulla id urna viverra eros fermentum vulputate vitae sit amet lorem. Curabitur varius viverra sollicitudin. In feugiat ultrices commodo. Duis ullamcorper sapien a dolor suscipit luctus. Duis quis nunc sed leo consequat congue ut sit amet lorem. Vivamus finibus mi consectetur risus efficitur eleifend. Aenean consequat ultricies molestie. Quisque at leo non sapien pulvinar elementum. Vivamus sit amet magna varius turpis suscipit volutpat. In hac habitasse platea dictumst. Praesent a libero id ipsum convallis interdum.


\section{Linker Implementation}
Duis consequat mauris a dolor ultrices eleifend. Quisque nulla est, dictum et augue ut, iaculis aliquet sem. Integer in sem dapibus, suscipit est eu, pellentesque velit. Praesent lacus massa, scelerisque ac rutrum nec, sodales nec risus. Aenean sed rhoncus nunc. Ut eget elit sapien. Aenean iaculis velit vel porta consequat. Ut eros ex, rutrum dapibus ex varius, gravida condimentum sapien. Etiam finibus, nulla sed sodales tincidunt, nulla purus malesuada nunc, at imperdiet eros lorem ut dui. In ullamcorper eget eros in euismod. Donec ipsum mi, viverra id urna et, iaculis aliquam tellus. Duis lobortis pellentesque elit, ut tempus mauris pretium sollicitudin.

Duis id facilisis justo. Suspendisse sed scelerisque felis. Donec varius convallis tempor. Praesent ipsum dui, molestie non molestie eu, tincidunt at enim. Interdum et malesuada fames ac ante ipsum primis in faucibus. Fusce non tempor leo. Praesent sit amet hendrerit purus. Aliquam ut tortor velit. Praesent sit amet dui euismod, semper sem at, viverra elit. Cras rutrum aliquet urna ac malesuada. Duis dui sapien, rutrum at congue et, iaculis eget lectus. Nulla lectus massa, ultrices ac tempus nec, lacinia quis nisi. Nulla turpis ipsum, faucibus eget nibh vitae, venenatis lobortis lectus. Maecenas pretium dictum elit. Duis sem risus, laoreet a eros vitae, semper condimentum neque.
